<!DOCTYPE html>
<style type='text/css'>
    html {
        background: rgba(0, 0, 0, 0);
    }

    #content-box {
        background: rgba(255, 255, 255, 1);
        border: 5px solid rgba(0, 0, 0, 1);
        border-radius: 0px 0px 0px 0px;
        padding: 30px;
        width: 300px;
        color: black;
        left: 0px;
        position: fixed;
        max-height: 100%;
        top: 0px;
        cursor: alias;
        height: 200px;
    }

    #textAreaDiv {
        left: 0px;
        width: 100%;
        height: 100%;
        position: relative;
    }

    #textArea {
        width: 100%;
        height: 100%;
    }

    #resize-bar {
        top: -35px;
        right: -35px;
        width: 5px;
        height: 270px;
        background: rgba(0, 0, 0,1);
        position: absolute;
    }

    #resize-bar-bottom {
        bottom: -35px;
        left: -35px;
        width: 370px;
        height: 5px;
        background: rgba(0, 0, 0,1);
        position: absolute;
    }

    #parts-list-container {
        background: rgba(255, 255, 255, 1);
        border: 5px solid rgba(0, 0, 0, 1);
        border-radius: 0px 0px 0px 0px;
        width: 300px;
        padding: 0px,0px,0px,0px;
        color: black;
        padding-left: 5px;
        right: 0px;
        max-height: 100%;
        position: fixed;
        top: 0px;
    }

    #resize-bar-parts-list {
        top: -5px;
        left: -11px;
        width: 6px;
        height: 40px;
        background: rgba(0, 0, 0,1);
        position: absolute;
        cursor: e-resize;
    }

    #openFile {
        left: 0px;
        bottom: 0px;
        zoom: 1.5;
        position: fixed;
    }

    #controls {
        position: fixed;
        text-align: center;
        bottom: 0px;
        zoom: 7;
        text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
    }

    #closeSidebar {
        width: 20px;
        height: 20px;
        left: 300px;
        top: -30px;
        position: absolute;
    }

    #openPartsList {
        position: absolute;
        margin-left: auto;
        right: 0px;
        top: 0px;
    }

    .part {
        background-color: red;
        text-align: center;
        border: 0px solid rgba(0, 0, 0, 1);
        margin-bottom:2px;
        display: inline-block;
        font-size: 15px;
        width: 271px;
    }

    #toggleEdit {
        width: 20px;
        height: 20px;
        left: 0px;
        top: -30px;
        position: absolute;
    }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="bootstrap.css">
<html>
<body>

	<div>
		<button onclick="openSidebar()" style="height: 20px; width: 20px; position: absolute; left: 0px; top: 0px;"><b>></b></button>
	</div>

    <div id='content-box' class='sidebar' style="display: block">
        <div id="resize-bar" onmouseover="changeToResizeCursor()" onmouseout="changeToNormalCursor()" onmousedown="dragContentBoxResizeBar = true"></div>
        <div id="resize-bar-bottom" onmouseover="changeToResizeCursorBottom()" onmouseout="changeToNormalCursor()" onmousedown="dragContentBoxResizeBarBottom = true"></div>
        <!--<div id="content-box-padding"></div>-->
        <button onclick="closeSidebar()" id="closeSidebar"><b>X</b></button>
        <button onclick="toggleEdit()" id="toggleEdit"><i class="fa" style="font-size: 20px">&#xf046;</i></button>
        <div id='textAreaDiv' onfocus="console.log('focus')" onblur="console.log('blur')">
            <textarea id="textArea"></textarea>
        </div>
    </div>


	<div id="openPartsList">
		<button onclick="openPartsList()" style=" height: 20px; width: 20px;"><b>&lt;</b></button>
	</div>

	<div id='parts-list-container'>
		<div id="resize-bar-parts-list" onmouseover="changeToResizeCursor()" onmouseout="changeToNormalCursor()" onmousedown="dragPartsListResizeBar = true"></div>
		<button onclick="closePartsList()" style=" width: 20px; height: 20px; left: -5px; position: relative;"><b>X</b></button>
        <div id="parts-list">
            &nbsp;<input type="checkbox" name="test" value="1" class='partCheckBox'>&nbsp;<div class='part' onmouseover='showBorder(this)' onmouseout='hideBorder(this)' id="test" style="background-color: mediumblue; color: black;">test</div>
        </div>
        <input type="checkbox" id="selectAll" onchange="toggleAll()">
	</div>

	<div id='controls'>
		<i class="fa" id="stepBack">&#xf048;</i>&nbsp;
		<i class="fa" id="repeat">&#xf0e2;</i>&nbsp;
		<i class="fa" id="playPause">&#xf04b;</i>&nbsp;
		<i class="fa" id="stepForward">&#xf051;</i>
	</div>

	<button id="openFile"><i class="fa">&#xf07c;</i></button>

	<script>
		function log(message) {
			console.log(message);
		}
	</script>



	<script>
		var contentBox = document.getElementById('content-box');
        var partsList = document.getElementById('parts-list-container');
        var resizeBar = document.getElementById('resize-bar');
        var resizeBarBottom = document.getElementById('resize-bar-bottom');
        var textArea = document.getElementById('textArea');
        var closeSideBar = document.getElementById('closeSidebar');
        var dragContentBoxResizeBar = false;
        var dragContentBoxResizeBarBottom = false;

        var partsList = document.getElementById('parts-list-container');
		var partsListResizeBar = document.getElementById('resize-bar-parts-list');
        var dragPartsListResizeBar = false;
        document.addEventListener('mouseup', function (e) {
            // Turn off dragging flag when user mouse is up
            dragPartsListResizeBar = false;
            dragContentBoxResizeBar = false;
            dragContentBoxResizeBarBottom = false;
        });


        document.addEventListener('mousemove', function (e) {
            if (dragContentBoxResizeBar) {
                if ((e.clientX - 65) > 20) {
                    contentBox.style.width = e.clientX - 65;
                    resizeBarBottom.style.width = e.clientX;
                }
                //right: 0px; does not work in powerUI for some reason
                closeSideBar.style.left = contentBox.style.width;

            }
            else if (dragPartsListResizeBar) {
                if ((document.body.clientWidth - e.clientX + 5) > 30) {
                    partsList.style.width = document.body.clientWidth - e.clientX + 5
                    var parts = document.getElementsByClassName("part");
                    for (i = 0; i < parts.length; i++) {
                        parts[i].style.width = document.body.clientWidth - e.clientX - 25;
                    }
                }
            }
            else if (dragContentBoxResizeBarBottom) {
                if ((e.clientY - 65) > 20) {
                    contentBox.style.height = e.clientY - 65;
                    resizeBar.style.height = e.clientY;
                }

            }
        });

        document.addEventListener('mousedown', function (e) {
            //unfocus the textbox when clicking somewhere else
            if ((e.target.id != "textArea") && editable) {
                document.getElementById("textArea").blur();
            }
        });


		function openSidebar() {
			contentBox.style.display = 'block';
			setContentBoxExtrasHeight();
		}
		function closeSidebar() {
            contentBox.style.display = 'none';
		}
		function openPartsList() {
            partsList.style.display = 'block';
            setPartsListExtrasHeight();
		}
		function closePartsList() {
			partsList.style.display = 'none';
		}

        var agv = importNamespace('AGV');
		function changeToResizeCursor() {
			agv.ChangeCursor.changeToResizeCursor();
        }
        function changeToResizeCursorBottom() {
            agv.ChangeCursor.changeToResizeCursorBottom();
        }
		function changeToNormalCursor() {
			agv.ChangeCursor.changeToNormalCursor();
        }

        function setContentBoxExtrasHeight(element) {
            resizeBar.style.height = contentBox.offsetHeight;
		}

        function setPartsListExtrasHeight(element) {
            partsListResizeBar.style.height = partsList.offsetHeight;
        }


        function showBorder(element) {
            element.style.border = "2px solid rgba(0, 0, 0, 1)";
        }

        //checkBox.checked = !checkBox.checked does not work for some reason
        function toggleCheckBox(name) {
            var checkBox = document.getElementsByName(name)[0];
            checkBox.checked = parseInt(checkBox.value);
            checkBox.value ^= 1;
        }

        function hideBorder(element){
            element.style.border = "0px solid rgba(0, 0, 0, 1)"
        }

        var instructionText = "";
        var textAreaDiv = document.getElementById("textAreaDiv");
        var editable = true;
        var toggleEditButton = document.getElementById("toggleEdit");

        function toggleEdit() {
            if (editable) {
                textAreaDiv = document.getElementById("textAreaDiv");
                instructionText = document.getElementById("textArea").innerText;
                textAreaDiv.innerHTML = instructionText;
                toggleEditButton.innerHTML = "<i class='fa' style='font-size: 20px'>&#xf044;</i>"
            } else {
                textAreaDiv.innerHTML = "<textarea id='textArea'></textarea>";
                document.getElementById("textArea").innerText = instructionText;
                toggleEditButton.innerHTML = "<i class='fa' style='font-size: 20px'>&#xf046;</i>"
            }
            editable = !editable;
            setContentBoxExtrasHeight();
        }

        var toggleAllElement = document.getElementById("selectAll");

        function toggleAll() {
            var checkBoxes = document.getElementsByClassName("partCheckBox");
            for (i = 0; i < checkBoxes.length; i++) {
                checkBoxes[i].checked = toggleAllElement.checked;
                if (toggleAllElement.checked) {
                    checkBoxes[i].value = "0";
                } else {
                    checkBoxes[i].value = "1";
                }
            }
        }
	</script>
</body>
	</html>
